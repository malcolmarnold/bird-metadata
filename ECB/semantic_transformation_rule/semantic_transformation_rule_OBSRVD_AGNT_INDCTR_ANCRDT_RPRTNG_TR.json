{
  "semantic_transformation_rule_id" : "OBSRVD_AGNT_INDCTR_ANCRDT_RPRTNG_TR",
  "transformation_url" : "https://gitlab.sofa.dev/bird-subgroups/bird-transformation-rules/-/blob/main/AnaCredit%20Subgroup/Derivation%20rules%20-%20Final/OBSRVD_AGNT_INDCTR_ANCRDT_RPRTNG/infosheet.md",
  "type_of_transformation" : "D",
  "maintenance_agency_id" : "ECB",
  "name" : "Observed agent indicator for Anacredit reporting derivation rule",
  "code" : "OBSRVD_AGNT_INDCTR_ANCRDT_RPRTNG_TR",
  "description" : "This derivation rule aims to obtain the Observed agent indicator for Anacredit reporting from its building blocks.",
  "algorithm" : "SET BIRD_PRTY_EIL.OBSRVD_AGNT_INDCTR_ANCRDT_RPRTNG =\nCASE\n    WHEN\n        BIRD_PRTY_IL.PRTY_ID IN (\n            SELECT BIRD_PRTY_IL.PRTY_ID\n            FROM BIRD_PRTY_IL\n            WHERE BIRD_PRTY_IL.PRTY_TYP = S122_A\n              AND BIRD_PRTY_IL.CNTRY¬¬_CD IN (AT, BE, BG, HR, CY, EE, FI, FR, DE, GR, IE, IT, LV, LT, LU, MT, NL, PT, SK, SI, ES)\n              AND BIRD_PRTY_IL.INSTTNL_UNT_GRP_ID IN (\n                    SELECT BIRD_GRP_IL.GRP_ID\n                    FROM BIRD_GRP_IL\n                    WHERE BIRD_GRP_IL.GRP_TYP = 18\n                      AND BIRD_GRP_IL.GRP_ID IN (\n                            SELECT BIRD_INTRNL_GRP_RL_IL.GRP_ID\n                            FROM BIRD_INTRNL_GRP_RL_IL\n                            WHERE BIRD_INTRNL_GRP_RL_IL.GRP_RL_TYP = 1\n                      )\n              )\n        )\n        OR\n        BIRD_PRTY_IL.PRTY_ID IN (\n            SELECT BIRD_PRTY_IL.PRTY_ID\n            FROM BIRD_PRTY_IL\n            WHERE BIRD_PRTY_IL.PRTY_TYP = 26\n              AND BIRD_PRTY_IL.INSTTNL_UNT_GRP_ID IN (\n                    SELECT BIRD_GRP_IL.GRP_ID\n                    FROM BIRD_GRP_IL\n                    WHERE BIRD_GRP_IL.GRP_TYP = 17\n              )\n              AND BIRD_PRTY_IL.ORGNSTN_PRTY_ID IN (\n                    SELECT BIRD_PRTY_IL.PRTY_ID\n                    FROM BIRD_PRTY_IL\n                    WHERE BIRD_PRTY_IL.PRTY_TYP = S122_A\n                      AND BIRD_PRTY_IL.CNTRY_CD IN (AT, BE, BG, HR, CY, EE, FI, FR, DE, GR, IE, IT, LV, LT, LU, MT, NL, PT, SK, SI, ES)\n                      AND BIRD_PRTY_IL.INSTTNL_UNT_GRP_ID IN (\n                            SELECT BIRD_GRP_IL.GRP_ID\n                            FROM BIRD_GRP_IL\n                            WHERE BIRD_GRP_IL.GRP_TYP = 18\n                              AND BIRD_GRP_IL.GRP_ID IN (\n                                    SELECT BIRD_INTRNL_GRP_RL_IL.GRP_ID\n                                    FROM BIRD_INTRNL_GRP_RL_IL\n                                    WHERE BIRD_INTRNL_GRP_RL_IL.GRP_RL_TYP = 1\n                              )\n                      )\n              )\n        )\n    THEN 1\n    ELSE 2\nEND;",
  "valid_from" : "2025-11-15",
  "valid_to" : "9999-12-31",
  "logical_transformation_rule" : [ {
    "logical_transformation_rule_id" : "DER__BIRD_PRTY_EIL_1__OBSRVD_AGNT_INDCTR_ANCRDT_RPRTNG__01_01_1990",
    "semantic_transformation_rule_id" : "OBSRVD_AGNT_INDCTR_ANCRDT_RPRTNG_TR",
    "algorithm" : "SET BIRD_PRTY_EIL.OBSRVD_AGNT_INDCTR_ANCRDT_RPRTNG =\nCASE\n    WHEN\n        BIRD_PRTY_IL.PRTY_ID IN (\n            SELECT BIRD_PRTY_IL.PRTY_ID\n            FROM BIRD_PRTY_IL\n            WHERE BIRD_PRTY_IL.PRTY_TYP = S122_A\n              AND BIRD_PRTY_IL.CNTRY_CD IN (AT, BE, BG, HR, CY, EE, FI, FR, DE, GR, IE, IT, LV, LT, LU, MT, NL, PT, SK, SI, ES)\n              AND BIRD_PRTY_IL.INSTTTNL_UNT_GRP_ID IN (\n                    SELECT BIRD_GRP_IL.GRP_ID\n                    FROM BIRD_GRP_IL\n                    WHERE BIRD_GRP_IL.GRP_TYP = 18\n                      AND BIRD_GRP_IL.GRP_ID IN (\n                            SELECT BIRD_INTRNL_GRP_RL_IL.GRP_ID\n                            FROM BIRD_INTRNL_GRP_RL_IL\n                            WHERE BIRD_INTRNL_GRP_RL_IL.GRP_RL_TYP = 1\n                      )\n              )\n        )\n        OR\n        BIRD_PRTY_IL.PRTY_ID IN (\n            SELECT BIRD_PRTY_IL.PRTY_ID\n            FROM BIRD_PRTY_IL\n            WHERE BIRD_PRTY_IL.PRTY_TYP = 26\n              AND BIRD_PRTY_IL.INSTTTNL_UNT_GRP_ID IN (\n                    SELECT BIRD_GRP_IL.GRP_ID\n                    FROM BIRD_GRP_IL\n                    WHERE BIRD_GRP_IL.GRP_TYP = 17\n              )\n              AND BIRD_PRTY_IL.ORGNSTN_PRTY_ID IN (\n                    SELECT BIRD_PRTY_IL.PRTY_ID\n                    FROM BIRD_PRTY_IL\n                    WHERE BIRD_PRTY_IL.PRTY_TYP = S122_A\n                      AND BIRD_PRTY_IL.CNTRY_CD IN (AT, BE, BG, HR, CY, EE, FI, FR, DE, GR, IE, IT, LV, LT, LU, MT, NL, PT, SK, SI, ES)\n                      AND BIRD_PRTY_IL.INSTTTNL_UNT_GRP_ID IN (\n                            SELECT BIRD_GRP_IL.GRP_ID\n                            FROM BIRD_GRP_IL\n                            WHERE BIRD_GRP_IL.GRP_TYP = 18\n                              AND BIRD_GRP_IL.GRP_ID IN (\n                                    SELECT BIRD_INTRNL_GRP_RL_IL.GRP_ID\n                                    FROM BIRD_INTRNL_GRP_RL_IL\n                                    WHERE BIRD_INTRNL_GRP_RL_IL.GRP_RL_TYP = 1\n                              )\n                      )\n              )\n        )\n    THEN 1\n    ELSE 2\nEND;",
    "additional_filters" : null,
    "source_layer" : "IL",
    "destination_layer" : "EIL",
    "transformation_type" : null,
    "valid_from" : "1990-01-01",
    "valid_to" : "9999-12-31"
  } ]
}