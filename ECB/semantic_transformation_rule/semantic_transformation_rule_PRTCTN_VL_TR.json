{
  "semantic_transformation_rule_id" : "PRTCTN_VL_TR",
  "transformation_url" : "https://gitlab.sofa.dev/bird-subgroups/bird-transformation-rules/-/blob/main/AnaCredit%20Subgroup/Derivation%20rules%20-%20Final/PRTCTN_VL/infosheet.md",
  "type_of_transformation" : "D",
  "maintenance_agency_id" : "ECB",
  "name" : "Protection value derivation rule",
  "code" : "PRTCTN_VL_TR",
  "description" : "This derivation rule aims to obtain the Protection value from its building blocks.",
  "algorithm" : "SET PRTCTN_VL =\n    CASE\n        WHEN\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n                   81, 83, 89, 86, 85, 88, 84, 13\n                )\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP =12\n                AND BIRD_SCRTY_EXCHNG_TRDBL_DRVTV_IL.SCRTY_EXCHNG_TRDBL_DRVTV_TYP IN\n                    (5, 6)\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT = 2\n                AND BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP = 39\n            )\n        THEN FV\n\n        WHEN\n            BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n               8, 106, 107, 108, 10\n            )\n            AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            AND BIRD_CLLTRL_IL.MRKT_VL IS NOT NULL\n        THEN MRKT_VL\n\n        WHEN\n            BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n               8, 106, 107, 108, 10\n            )\n            AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            AND BIRD_CLLTRL_IL.MRKT_VL IS NULL\n            AND BIRD_CLLTRL_IL.LT_SSTNBL_VL IS NOT NULL\n        THEN LT_SSTNBL_VL\n\n        WHEN\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP IN (2, 66, 72, 77, 17)\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP = 12\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n                AND BIRD_SCRTY_EXCHNG_TRDBL_DRVTV_IL.SCRTY_EXCHNG_TRDBL_DRVTV_TYP NOT IN\n                    (5, 6)\n            )\n            OR\n            (\n                BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP = 39\n                AND BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT IN (\n                    12, 511, 512, 522, 51, 80, 1022, 13, 14\n                )\n            )\n            OR\n            (\n                BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP IN (\n                    39, 6, 38\n                )\n                AND BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT IN (\n                    5, 6, 7, 8, 9, 10, 380\n                )\n            )\n        THEN NTNL_AMNT\n\n    END;",
  "valid_from" : "2025-11-15",
  "valid_to" : "9999-12-31",
  "logical_transformation_rule" : [ {
    "logical_transformation_rule_id" : "DER__BIRD_CLLTRL_RL_EIL_1__PRTCTN_VL__01_01_1990",
    "semantic_transformation_rule_id" : "PRTCTN_VL_TR",
    "algorithm" : "SET BIRD_CLLTRL_RL_EIL.PRTCTN_VL =\n    CASE\n        WHEN\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n                   81, 83, 89, 86, 85, 88, 84, 13\n                )\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP =12\n                AND BIRD_SCRTY_EXCHNG_TRDBL_DRVTV_IL.SCRTY_EXCHNG_TRDBL_DRVTV_TYP IN\n                    (5, 6)\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT = 2\n                AND BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP = 39\n            )\n        THEN BIRD_CLLTRL_IL.FV_AMNT_CLLTRL\n\n        WHEN\n            BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n               8, 106, 107, 108, 10\n            )\n            AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            AND BIRD_CLLTRL_IL.MRKT_VL IS NOT NULL\n        THEN BIRD_CLLTRL_IL.MRKT_VL\n\n        WHEN\n            BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n               8, 106, 107, 108, 10\n            )\n            AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            AND BIRD_CLLTRL_IL.MRKT_VL IS NULL\n            AND BIRD_CLLTRL_IL.LT_SSTNBL_VL IS NOT NULL\n        THEN BIRD_CLLTRL_IL.LT_SSTNBL_VL\n\n        WHEN\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP IN (2, 66, 72, 77, 17)\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP = 12\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n                AND BIRD_SCRTY_EXCHNG_TRDBL_DRVTV_IL.SCRTY_EXCHNG_TRDBL_DRVTV_TYP NOT IN\n                    (5, 6)\n            )\n            OR\n            (\n                BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP = 39\n                AND BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT IN (\n                    12, 511, 512, 522, 51, 80, 1022, 13, 14\n                )\n            )\n            OR\n            (\n                BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP IN (\n                    39, 6, 38\n                )\n                AND BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT IN (\n                    5, 6, 7, 8, 9, 10, 380\n                )\n            )\n        THEN BIRD_CLLTRL_IL.NTNL_AMNT\n\n    END;",
    "additional_filters" : null,
    "source_layer" : "IL",
    "destination_layer" : "EIL",
    "transformation_type" : null,
    "valid_from" : "1990-01-01",
    "valid_to" : "9999-12-31"
  }, {
    "logical_transformation_rule_id" : "DER__BIRD_INSTRMNT_RL_EIL_1__PRTCTN_VL__01_01_1990",
    "semantic_transformation_rule_id" : "PRTCTN_VL_TR",
    "algorithm" : "SET BIRD_INSTRMNT_RL_EIL.PRTCTN_VL =\n    CASE\n        WHEN\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n                   81, 83, 89, 86, 85, 88, 84, 13\n                )\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP =12\n                AND BIRD_SCRTY_EXCHNG_TRDBL_DRVTV_IL.SCRTY_EXCHNG_TRDBL_DRVTV_TYP IN\n                    (5, 6)\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT = 2\n                AND BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP = 39\n            )\n        THEN BIRD_INSTRMNT_RL_IL.FV\n\n        WHEN\n            BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n               8, 106, 107, 108, 10\n            )\n            AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            AND BIRD_CLLTRL_IL.MRKT_VL IS NOT NULL\n        THEN BIRD_CLLTRL_IL.MRKT_VL\n\n        WHEN\n            BIRD_CLLTRL_IL.CLLTRL_TYP IN (\n               8, 106, 107, 108, 10\n            )\n            AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            AND BIRD_CLLTRL_IL.MRKT_VL IS NULL\n            AND BIRD_CLLTRL_IL.LT_SSTNBL_VL IS NOT NULL\n        THEN BIRD_CLLTRL_IL.LT_SSTNBL_VL\n\n        WHEN\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP IN (2, 66, 72, 77, 17)\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n            )\n            OR\n            (\n                BIRD_CLLTRL_IL.CLLTRL_TYP = 12\n                AND BIRD_CLLTRL_RL_IL.CLLTRL_RL_TYP = 1\n                AND BIRD_SCRTY_EXCHNG_TRDBL_DRVTV_IL.SCRTY_EXCHNG_TRDBL_DRVTV_TYP NOT IN\n                    (5, 6)\n            )\n            OR\n            (\n                BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP = 39\n                AND BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT IN (\n                    12, 511, 512, 522, 51, 80, 1022, 13, 14\n                )\n            )\n            OR\n            (\n                BIRD_INSTRMNT_RL_IL.INSTRMNT_RL_TYP IN (\n                    39, 6, 38\n                )\n                AND BIRD_INSTRMNT_IL.INSTRMNT_TYP_PRDCT IN (\n                    5, 6, 7, 8, 9, 10, 380\n                )\n            )\n        THEN BIRD_INSTRMNT_IL.NTNL_AMNT\n\n    END;",
    "additional_filters" : null,
    "source_layer" : "IL",
    "destination_layer" : "EIL",
    "transformation_type" : null,
    "valid_from" : "1990-01-01",
    "valid_to" : "9999-12-31"
  } ]
}